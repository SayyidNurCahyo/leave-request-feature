CREATE TABLE `EmployeeList` (
    `EmployeeID`	INT,
    `Name`	VARCHAR(512),
    `Birth Place`	VARCHAR(512),
    `SEX`	VARCHAR(512),
    `Birth_date`	VARCHAR(512),
    `Status`	VARCHAR(512),
    `JoinDate`	VARCHAR(512),
    `Dept`	VARCHAR(512),
    `JobTitle`	VARCHAR(512)
);

INSERT INTO `EmployeeList` (`EmployeeID`, `Name`, `Birth Place`, `SEX`, `Birth_date`, `Status`, `JoinDate`, `Dept`, `JobTitle`) VALUES ('11001', 'ANGGA MEI DIANTO', 'KEDIRI', 'M', '31/03/1997', 'Kontrak', '01/03/2024', 'Depo Surabaya', 'Kepala Depo');
INSERT INTO `EmployeeList` (`EmployeeID`, `Name`, `Birth Place`, `SEX`, `Birth_date`, `Status`, `JoinDate`, `Dept`, `JobTitle`) VALUES ('11002', 'DADANG SETIAWAN', 'SURABAYA', 'M', '25/11/1997', 'Tetap', '01/08/2023', 'Marketing', 'Manager');
INSERT INTO `EmployeeList` (`EmployeeID`, `Name`, `Birth Place`, `SEX`, `Birth_date`, `Status`, `JoinDate`, `Dept`, `JobTitle`) VALUES ('11003', 'DANIEL TATO ALIK', 'SURABAYA', 'M', '19/05/1996', 'Tetap', '01/11/2019', 'sales', 'Sales Rep');
INSERT INTO `EmployeeList` (`EmployeeID`, `Name`, `Birth Place`, `SEX`, `Birth_date`, `Status`, `JoinDate`, `Dept`, `JobTitle`) VALUES ('11004', 'RISKY SCORFANIE', 'MALANG', 'M', '23/04/1998', 'Tetap', '06/01/2019', 'sales', 'Supervisor');
INSERT INTO `EmployeeList` (`EmployeeID`, `Name`, `Birth Place`, `SEX`, `Birth_date`, `Status`, `JoinDate`, `Dept`, `JobTitle`) VALUES ('11005', 'RIZKY PRASTIKA', 'JEMBER', 'M', '24/04/1996', 'Tetap', '09/01/2023', 'sales', 'Sales Rep');
INSERT INTO `EmployeeList` (`EmployeeID`, `Name`, `Birth Place`, `SEX`, `Birth_date`, `Status`, `JoinDate`, `Dept`, `JobTitle`) VALUES ('11006', 'SARAH HUSNUL KHOTIMAH', 'BANYUWANGI', 'F', '26/10/1997', 'Tetap', '10/01/2021', 'sales', 'Sales Rep');
INSERT INTO `EmployeeList` (`EmployeeID`, `Name`, `Birth Place`, `SEX`, `Birth_date`, `Status`, `JoinDate`, `Dept`, `JobTitle`) VALUES ('11007', 'DENDI SUPARDI IRAWAN', 'BANYUWANGI', 'M', '21/08/1997', 'Tetap', '09/08/2024', 'sales', 'Sales Rep');
INSERT INTO `EmployeeList` (`EmployeeID`, `Name`, `Birth Place`, `SEX`, `Birth_date`, `Status`, `JoinDate`, `Dept`, `JobTitle`) VALUES ('11008', 'TIRA ASTRIYANI', 'BANYUWANGI', 'F', '07/07/1996', 'Tetap', '18/03/2024', 'sales', 'Sales Rep');
INSERT INTO `EmployeeList` (`EmployeeID`, `Name`, `Birth Place`, `SEX`, `Birth_date`, `Status`, `JoinDate`, `Dept`, `JobTitle`) VALUES ('11009', 'HARDINTIA W.S', 'BANYUWANGI', 'M', '25/02/1998', 'Tetap', '01/09/2017', 'sales', 'Sales Rep');
INSERT INTO `EmployeeList` (`EmployeeID`, `Name`, `Birth Place`, `SEX`, `Birth_date`, `Status`, `JoinDate`, `Dept`, `JobTitle`) VALUES ('11010', 'DEDE SUHENDRI', 'SIDOARJO', 'M', '14/05/1998', 'Tetap', '01/09/2017', 'Pengiriman', 'Driver');
INSERT INTO `EmployeeList` (`EmployeeID`, `Name`, `Birth Place`, `SEX`, `Birth_date`, `Status`, `JoinDate`, `Dept`, `JobTitle`) VALUES ('11011', 'RIAN PRASETYO', 'SURABAYA', 'M', '16/05/1995', 'Tetap', '04/09/2017', 'Pengiriman', 'Driver');
INSERT INTO `EmployeeList` (`EmployeeID`, `Name`, `Birth Place`, `SEX`, `Birth_date`, `Status`, `JoinDate`, `Dept`, `JobTitle`) VALUES ('11012', 'SAEPUL BAHRI', 'SURABAYA', 'M', '29/11/1997', 'Kontrak', '01/07/2024', 'Pengiriman', 'Driver');
INSERT INTO `EmployeeList` (`EmployeeID`, `Name`, `Birth Place`, `SEX`, `Birth_date`, `Status`, `JoinDate`, `Dept`, `JobTitle`) VALUES ('11013', 'EDI WAHYUDIN', 'SIDOARJO', 'M', '17/07/1998', 'Kontrak', '01/07/2024', 'Pengiriman', 'Driver');
INSERT INTO `EmployeeList` (`EmployeeID`, `Name`, `Birth Place`, `SEX`, `Birth_date`, `Status`, `JoinDate`, `Dept`, `JobTitle`) VALUES ('11014', 'ARPAN', 'SURABAYA', 'M', '03/10/1995', 'Tetap', '09/09/2017', 'Pengiriman', 'Driver');
INSERT INTO `EmployeeList` (`EmployeeID`, `Name`, `Birth Place`, `SEX`, `Birth_date`, `Status`, `JoinDate`, `Dept`, `JobTitle`) VALUES ('11015', 'YOGI BACHTIAR', 'SURABAYA', 'M', '26/10/1997', 'Tetap', '25/09/2018', 'Pengiriman', 'Driver');
INSERT INTO `EmployeeList` (`EmployeeID`, `Name`, `Birth Place`, `SEX`, `Birth_date`, `Status`, `JoinDate`, `Dept`, `JobTitle`) VALUES ('11016', 'ASEP SUHERMAN', 'SIDOARJO', 'M', '29/05/1997', 'Tetap', '06/10/2021', 'Pengiriman', 'Supervisor');
INSERT INTO `EmployeeList` (`EmployeeID`, `Name`, `Birth Place`, `SEX`, `Birth_date`, `Status`, `JoinDate`, `Dept`, `JobTitle`) VALUES ('11017', 'AGUSTINUS ARI WIBOWO', 'SIDOARJO', 'M', '02/10/1996', 'Tetap', '26/10/2021', 'hrd & GA', 'Manager');
INSERT INTO `EmployeeList` (`EmployeeID`, `Name`, `Birth Place`, `SEX`, `Birth_date`, `Status`, `JoinDate`, `Dept`, `JobTitle`) VALUES ('11018', 'AGNES DEBORA', 'SIDOARJO', 'F', '19/06/1996', 'Tetap', '25/11/2022', 'hrd & GA', 'Staff');
INSERT INTO `EmployeeList` (`EmployeeID`, `Name`, `Birth Place`, `SEX`, `Birth_date`, `Status`, `JoinDate`, `Dept`, `JobTitle`) VALUES ('11019', 'HERY MARYANTO', 'SURABAYA', 'M', '12/03/1997', 'Tetap', '08/12/2018', 'hrd & GA', 'Staff');
INSERT INTO `EmployeeList` (`EmployeeID`, `Name`, `Birth Place`, `SEX`, `Birth_date`, `Status`, `JoinDate`, `Dept`, `JobTitle`) VALUES ('11020', 'ANTO AGUS SURIPNO', 'SIDOARJO', 'M', '03/11/1998', 'Tetap', '24/12/2017', 'Warehouse', 'Staff');
INSERT INTO `EmployeeList` (`EmployeeID`, `Name`, `Birth Place`, `SEX`, `Birth_date`, `Status`, `JoinDate`, `Dept`, `JobTitle`) VALUES ('11021', 'YUSLAN', 'SIDOARJO', 'M', '05/05/1996', 'Tetap', '04/01/2018', 'Warehouse', 'Staff');
INSERT INTO `EmployeeList` (`EmployeeID`, `Name`, `Birth Place`, `SEX`, `Birth_date`, `Status`, `JoinDate`, `Dept`, `JobTitle`) VALUES ('11022', 'TOMO', 'SURABAYA', 'M', '14/09/1996', 'Tetap', '05/01/2023', 'Warehouse', 'Staff');
INSERT INTO `EmployeeList` (`EmployeeID`, `Name`, `Birth Place`, `SEX`, `Birth_date`, `Status`, `JoinDate`, `Dept`, `JobTitle`) VALUES ('11023', 'MOH. DANI ADNANI', 'SIDOARJO', 'M', '10/02/1994', 'Tetap', '06/01/2019', 'Warehouse', 'Staff');


ALTER TABLE employeelist ADD COLUMN leave_balance INT;


DELIMITER //
CREATE FUNCTION calculate_leave_balance(join_date DATE)
RETURNS INT
BEGIN
    DECLARE months_worked INT;
    SET months_worked = TIMESTAMPDIFF(MONTH, join_date, CURDATE());

    IF months_worked >= 12 THEN
        RETURN 12;
    ELSEIF months_worked >= 6 THEN
        RETURN 6;
    ELSE
        RETURN 0;
    END IF;
END //
DELIMITER ;


UPDATE employeelist SET leave_balance = calculate_leave_balance(STR_TO_DATE(JoinDate, '%d/%m/%Y'));


CREATE TABLE leave_requests (
    id INT PRIMARY KEY AUTO_INCREMENT,
    EmployeeID INT,
    request_date DATE NOT NULL,
    start_date DATE NOT NULL,
    end_date DATE NOT NULL,
    status ENUM('approved', 'rejected'),
    FOREIGN KEY (EmployeeID) REFERENCES employeelist(EmployeeID)
);
